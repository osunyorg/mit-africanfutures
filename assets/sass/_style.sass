// SYSTEM
// header's colors
header#document-header
    .page-mobilization &,
    .ancestor-mobilization &
        &, html.has-menu-opened &, 
            background-color: $mobilizing-red
            .dropdown-menu
                background-color: $mobilizing-red
    .page-podcast &,
    .category-podcast &
        &, &.is-sticky, html.has-menu-opened &, 
            background-color: $podcast-orange
            span, a, button
                &, &:focus, &:hover
                    color: var(--color-text)
            .dropdown-menu
                background-color: $podcast-orange
                span, a, button
                    &, &:focus, &:hover
                        color: var(--color-text)
    .events__section &,
    .events__page &,
    .events_categories__term &
        .logo
            filter: invert(1)
        &, &.is-sticky, html.has-menu-opened &, 
            background-color: $agenda-yellow
            span, a, button
                &, &:focus, &:hover
                    color: var(--color-text)
            .dropdown-menu
                background-color: $agenda-yellow
                span, a, button
                    &, &:focus, &:hover
                        color: var(--color-text)
    .page-research &,
    .ancestor-research &
        &, html.has-menu-opened &, 
            background-color: $investigation-purple
            .dropdown-menu
                background-color: $investigation-purple
// hero
header.hero
    .content
        .hero-text
            margin-top: 0
    @include media-breakpoint-up(desktop)
        body:not(.page__event, .page__home) &--with-image
            .hero-text
                width: columns(7)
            figure
                width: columns(5)

// footer
footer#document-footer
    .container:first-child
        gap: var(--grid-gutter)
        .footer-address
            flex: 1
            p:first-of-type
                @include h3
            p:not(:first-of-type)
                @include signature
            p + p 
                margin-top: space()
            @include media-breakpoint-up(desktop)
                text-align: right
    .footer-logo
        figure
            align-items: center
            display: flex
            gap: $spacing-2
            @include media-breakpoint-up(desktop)
                figcaption
                    max-width: 20ch

.footer-menu
    padding-top: $spacing-2
    ul
        @include list-reset
        display: flex
        flex-wrap: wrap
        gap: $spacing-3
        span, a
            @include meta
            color: var(--color-accent)
            text-decoration: none
            &:hover
                @include link(var(--color-accent))
    body[class*="__section"] main.page-with-blocks &,
    body[class*="_categories__term"] main.page-with-blocks &,
    body[class*="__section"] &
        margin-bottom: -$spacing-4
    body[class*="__page"] main.page-with-blocks &,
    .page__home &
        margin-bottom: $spacing-2
    .events__section &
        margin-top: $spacing-4

// subtitles
.posts,
.block-posts,
.pages,
.events
    [class*="-subtitle"]
        color: var(--color-accent)

// HOME
.page__home
    .breadcrumb 
        li
            &, &.active
                span, a, &::before
                    color: var(--color-background)
    .hero
        &, 
        figure figcaption .credit,
        figure figcaption::before
            background-color: var(--color-accent)
            color: var(--color-background)
        @include media-breakpoint-up(desktop)
            .hero-text,
            figure
                width: columns(6)
                max-height: pxToRem(576)
            figure
                @include media-breakpoint-up(xl)
                    width: columns(5)
                @include media-breakpoint-up(xxl)
                    width: columns(4)
        .hero-text
            hgroup 
                > p:first-of-type
                    margin-top: $spacing-4
                    b
                        font-weight: normal
                        @include media-breakpoint-up(xxl)
                            font-size: pxToRem(60)
                            line-height: pxToRem(72)
                    + p
                        margin-top: $spacing-4
                > p:not(:first-of-type)
                    @include h3
                    font-weight: normal
        @include media-breakpoint-down(desktop)
            &--image
                &-portrait:where(:not(.has-breadcrumb-hero-end)), 
                &-square:where(:not(.has-breadcrumb-hero-end))
                    margin-bottom: $spacing-3
                    figure
                        margin-bottom: 0
    .block-call_to_action--accent_background:not(.block-class-cta-mobilization)
        .actions
            a:first-child
                --btn-background: #{$agenda-yellow}
                --btn-border: 1px solid #{$agenda-yellow}
            a:nth-child(2)
                --btn-background: var(--color-accent)
                --btn-border: 1px solid var(--color-accent)
                --btn-color: var(--color-background)
    &.full-width
        .block-call_to_action--accent_background + .block-call_to_action--accent_background,
        .block-call_to_action--accent_background + .block-chapter--alt_background,
        .block-chapter--alt_background + .block-call_to_action--accent_background
            margin-top: 0
    .block-class-cta-mobilization
        .call_to_action .top
            .block-title
                @include h5
                text-transform: uppercase
            
// SECTIONS
.block-title
    &.block-class-moblab
        h2::before
            content: "MobLab / "
            color: $mobilizing-red
    &.block-class-campaign
        h2::before
            content: "Campaign / "
            color: $mobilizing-red

.events
    .event--with-image
        .media img
            aspect-ratio: 1
            object-fit: cover

.posts--list
    .media img
        aspect-ratio: 1 !important

.block-pages--grid
    .media
        picture.is-png
            background-color: $light-purple
            padding: $spacing-3

// BLOCKS
// title
.block.block-title
    h2
        @include h1

// call to action
.block-call_to_action
    .block-title + &:not(.block-titled)
        @include in-page-with-or-without-sidebar
            .block-content
                padding-top: 0
    .call_to_action
        .top
            .block-title
                @include h1
            .description
                @include lead
                margin-top: $spacing-4
                p
                    font-weight: normal
        &--with-image
            body.full-width:not(.page__home) &
                figure
                    grid-column: 10/13
                    button, img
                        width: 100%
    &--no_background
        .actions
            a:not(:first-child)
                --btn-background: var(--color-background)
                --btn-hover-background: var(--btn-background)
                --btn-color: var(--color-text)
                --btn-border: none
                --btn-hover-border: none
                --btn-hover-color: var(--btn-color)
                @include link
        @include in-page-with-sidebar
            .call_to_action--with-image
                flex-direction: column
                figure
                    margin-left: 0
                    order: -1
    &.block-class-cta-mobilization,
    .page-mobilization &,
    .ancestor-mobilization &
        --cta-background-color: #{$mobilizing-red}
    // yellow in events
    .events__section &,
    .events__page &,
    .page-about &,
    .ancestor-about &
        &--no_background
            .actions a:first-child
                --btn-background: #{$agenda-yellow}
                --btn-color: var(--color-text)
                --btn-border: 1px solid #{$agenda-yellow}
    .events__section &,
    .events__page &
        &--accent_background
            --cta-background-color: #{$agenda-yellow}
    // purple in researc
    .page-research &,
    .ancestor-research &
        &--no_background
            .actions a:first-child
                --btn-background: #{$investigation-purple}
    .page-research &,
    .ancestor-research &
        &--accent_background
            --cta-background-color: #{$investigation-purple}
            .call_to_action
                color: var(--color-background)
    .page-about &,
    .ancestor-about &
        &--accent_background
            --cta-background-color: #{$light-purple}
            .call_to_action
                color: var(--color-accent)
                .actions a
                    --btn-background: var(--color-accent)
                    --btn-border: 1px solid var(--color-accent)
                    --btn-color: var(--color-background)
    // orange in podcast
    .page-podcast &,
    .ancestor-podcast &
        &--no_background
            .actions a:first-child
                background: #{$podcast-orange}
    .page-podcast &,
    .ancestor-podcast &
        &--accent_background
            --cta-background-color: #{$podcast-orange}
// chapter
.block-chapter
    &--alt_background
        .page__home &
            .notes
                @include h2
// organizations
.block-organizations
    &:not(.block-organizations--map),
    &--grid
        .organization
            .media
                background: none
                padding: 0
        .page__home &
            .organization-title
                @extend .sr-only
        @include in-page-without-sidebar
            .organizations
                @include grid(4, desktop)
                margin-left: offset(2)
                margin-right: offset(2)
                .organization
                @include media-breakpoint-up(desktop)
                    .organization
                        width: columns(2)
//files
.block-files
    .files 
        li
            &::before
                border-radius: 8px
            &.with-image picture img 
                aspect-ratio: 1 / 1
                object-fit: cover
                width: 100%
            &:hover::before
                background-color: $color-accent
            .events__section &,
            .events__page &,
            .events_categories__term &
                &:not(:hover)::before
                    background-color: $agenda-yellow
                    border-color: $agenda-yellow

//agenda
.block-agenda--list
    .event--with-image
        .media img
            aspect-ratio: 1 / 1
            object-fit: cover
    .event-categories a
        color: $color-accent

//pages
.block-pages,
.block-posts
    &--grid
        article
            .media img
                aspect-ratio: 1 !important
    &--large
        .large
            .page,
            .post
                .media 
                    margin-bottom: 0
                    picture
                        &, &.is-svg
                            img
                                aspect-ratio: 16/9 !important
                                object-fit: cover
                @include in-page-without-sidebar
                    [class$="-title"],
                    [class$="-subtitle"]
                        @include h2
                        font-weight: normal

// key_figures
.block-key_figures
    ul li
        @include meta